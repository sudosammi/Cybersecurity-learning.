import socket

def start_logger():
    # Technical Syntax: Standard Raw Socket for Sniffing
    sniffer = socket.socket(socket.AF_PACKET, socket.SOCK_RAW, socket.ntohs(3))
    print("[*] Packet Logger Active... Saving to 'network_log.txt'")

    # Technical Logic: Opening a file in 'Append' mode
    with open("network_log.txt", "a") as log_file:
        while True:
            try:
                raw_data, addr = sniffer.recvfrom(65535)
                
                # Payload extraction (Layer 7)
                payload = raw_data[54:].decode('utf-8', errors='ignore')

                if len(payload) > 0:
                    # Formatting the log entry
                    log_entry = f"From: {addr} | Data: {payload[:50]}\n"
                    log_file.write(log_entry)
                    log_file.flush() # Data ko turant disk par save karne ke liye
                    print(f"[+] Saved packet from {addr}")

            except KeyboardInterrupt:
                print("\n[X] Logging Stopped.")
                break

start_logger()
